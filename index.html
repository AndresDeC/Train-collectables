<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RailCollect - Trenes Coleccionables</title>
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fuente Inter (Usada en styles/styles.css) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <!-- Carga de Estilos Personalizados -->
    <link rel="stylesheet" href="styles/styles.css">
    
    <style>
        /* Clases auxiliares para la lógica JS */
        .error-msg { /* Estilo para mensajes de error de Firebase */
            color: #dc3545;
            background-color: rgba(220, 53, 69, 0.1);
            padding: 10px;
            text-align: center;
        }
        .success-msg { /* Estilo para mensajes de éxito */
            color: #28a745;
            background-color: rgba(40, 167, 69, 0.1);
            padding: 10px;
            text-align: center;
        }
    </style>
</head>
<body class="bg-[#1a1a1a]">

    <!-- 1. ENCABEZADO Y NAVEGACIÓN -->
    <header id="app-header">
        <div class="logo">RailCollect</div>
        
        <nav id="app-nav" class="flex items-center gap-6">
            <!-- Navegación Pública (Siempre visible) -->
            <a href="#" class="nav-link border-b-4 border-red-600" data-view="landing-view">Inicio</a>
            
            <!-- Navegación Protegida (Oculta por defecto) -->
            <a id="nav-catalog" href="#" class="nav-link hidden" data-view="catalog-view">Catálogo</a>
            <a id="nav-profile" href="#" class="nav-link hidden" data-view="profile-view">Mi Perfil</a>
            
            <!-- Botón de Usuario/Login -->
            <span id="user-display" class="hidden text-sm font-semibold text-white"></span>
            <button id="show-login-btn" class="btn btn-primary">Iniciar Sesión / Registrarse</button>
            <button id="logout-btn" class="btn btn-secondary hidden">Cerrar Sesión</button>
        </nav>
    </header>

    <!-- 2. CONTENIDO PRINCIPAL (VISTAS SPA) -->
    <main id="main-content">
        
        <!-- VISTA DE ATERRIZAJE (PÚBLICO) -->
        <section id="landing-view" class="view active">
            <h2 class="text-4xl text-center mb-10 text-white font-bold">¡Bienvenido a RailCollect!</h2>
            <p class="text-center text-lg mb-8 text-[#ccc]">Tu destino para colecciones exclusivas de trenes a escala. Regístrate o inicia sesión para explorar nuestro catálogo completo. Mientras tanto, déjanos tus datos y te avisaremos de las novedades.</p>
            
            <!-- Formulario de Interés Público (Gestionado por app/leads.js) -->
            <div id="public-lead-form" class="lead-form-container bg-[#282828] p-8 rounded-xl shadow-lg max-w-lg mx-auto">
                <h3 class="text-2xl text-center text-white mb-6">Déjanos tu Interés</h3>
                <form id="interest-form" class="flex flex-col gap-4">
                    <input type="text" id="interest-name" placeholder="Tu Nombre" required class="p-3">
                    <input type="email" id="interest-email" placeholder="Tu Correo Electrónico" required class="p-3">
                    <textarea id="interest-message" placeholder="¿Qué tipo de tren te interesa? (Opcional)" rows="3" class="p-3"></textarea>
                    <div id="public-message" class="hidden"></div>
                    <button type="submit" class="btn btn-primary">Enviar Interés</button>
                </form>
            </div>
        </section>

        <!-- VISTA DE CATÁLOGO (PROTEGIDA) -->
        <section id="catalog-view" class="view hidden">
            <h2 class="text-3xl text-white font-bold border-b border-gray-700 pb-3 mb-6">Catálogo de Trenes Exclusivos</h2>
            <!-- El contenido se inyectará aquí (gestionado por app/firestore.js) -->
            <div id="catalog-list" class="grid-layout">
                <p class="text-center text-gray-500">Cargando catálogo...</p>
            </div>
        </section>

        <!-- VISTA DE PERFIL (PROTEGIDA) -->
        <section id="profile-view" class="view hidden">
            <div class="auth-card">
                <h2 class="text-3xl text-white font-bold mb-4">Detalles de Mi Cuenta</h2>
                <p class="text-gray-400 mb-2">Email: <span id="profile-email" class="text-white font-medium">N/A</span></p>
                <p class="text-gray-400 mb-4">Miembro desde: <span id="profile-date" class="text-white font-medium">N/A</span></p>
                
                <h3 class="text-xl text-white font-bold mt-6 mb-4 border-t border-gray-700 pt-4">Mis Artículos de Interés</h3>
                <!-- Los leads guardados se inyectarán aquí (gestionado por app/leads.js) -->
                <div id="user-leads-list" class="flex flex-col gap-3">
                    <p class="text-gray-500">No has marcado ningún artículo como favorito.</p>
                </div>
            </div>
        </section>

    </main>
    
    <!-- 3. MODAL DE AUTENTICACIÓN (Login/Registro) -->
    <div id="login-modal-container" class="modal-backdrop hidden">
        <div class="auth-card modal-content">
            <div class="flex justify-end">
                <button id="close-login-modal" class="text-gray-500 hover:text-white text-2xl leading-none">
                    &times;
                </button>
            </div>
            <h2 id="auth-title" class="text-2xl text-center text-white font-bold">Inicia Sesión para Acceder al Catálogo</h2>
            
            <form id="auth-form" class="flex flex-col gap-4">
                <input type="email" id="email-input" placeholder="Correo Electrónico" required class="p-3">
                <input type="password" id="password-input" placeholder="Contraseña (mín. 6 caracteres)" required class="p-3">
                <div id="error-message" class="hidden error-msg"></div>
                <button id="auth-submit-btn" type="submit" class="btn btn-primary">Iniciar Sesión</button>
            </form>

            <div class="separator">O</div>

            <button id="google-login-btn" class="btn btn-google">
                <img class="google-logo" src="https://upload.wikimedia.org/wikipedia/commons/4/4a/Logo-google.png" onerror="this.src='https://placehold.co/20x20/ffffff/000?text=G'" alt="Logo Google">
                Continuar con Google
            </button>

            <button id="toggle-mode-btn" class="text-sm text-center text-gray-400 hover:text-white mt-2">
                ¿No tienes cuenta? Regístrate
            </button>
        </div>
    </div>

    <!-- 4. SCRIPTS DE APLICACIÓN -->
    <script type="module" src="app/auth.js"></script>
    <script type="module" src="app/firestore.js"></script>
    <script type="module" src="app/leads.js"></script>
</body>
</html>